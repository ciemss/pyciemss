<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Test Vega SVG Fill Patterns</title>
<script src="https://vega.github.io/vega/vega.min.js"></script>
</head>
<body>

<!-- SVG Pattern Fills -->
<svg height="0" width="0" xmlns="http://www.w3.org/2000/svg" version="1.1"> 
  <defs> 
    <pattern id="circles-1" patternUnits="userSpaceOnUse" width="10" height="10"> 
      <circle cx="5" cy="5" r="2" fill="black" />
    </pattern>
    <pattern id="diagonal-stripe-2" patternUnits="userSpaceOnUse" width="10" height="10"> 
      <path d="M0,0 L10,10 M-5,5 L5,15 M5,-5 L15,5" stroke="black" stroke-width="2" />
    </pattern>
  </defs> 
</svg>

<div id="vis"></div>

<script type="text/javascript">
  var vega_spec = {
    "$schema": "https://vega.github.io/schema/vega/v5.json",
    "description": "An area chart showing the monthly stock prices of AAPL over the past few years.",
    "width": 500,
    "height": 200,
    "padding": 5,

    "data": [
      {
        "name": "stocks",
        "url": "https://vega.github.io/vega-lite/data/stocks.csv",
        "format": {"type": "csv"},
        "transform": [
          { "type": "filter", "expr": "datum.symbol === 'AAPL'" },
          { "type": "formula", "as": "date", "expr": "toDate(datum.date)"}
        ]
      }
    ],

    "scales": [
      {
        "name": "xscale",
        "type": "time",
        "domain": {"data": "stocks", "field": "date"},
        "range": "width"
      },
      {
        "name": "yscale",
        "type": "linear",
        "domain": {"data": "stocks", "field": "price"},
        "range": "height"
      },
      {
        "name": "pattern",
        "type": "ordinal",
        "range": ["url(#diagonal-stripe-2)", "url(#circles-1)"],
        "domain": ["AAPL"]
      }
    ],

    "axes": [
      {"orient": "bottom", "scale": "xscale", "grid": true, "title": "Date"},
      {"orient": "left", "scale": "yscale", "grid": true, "title": "Price"}
    ],

    "marks": [
      {
        "type": "area",
        "from": {"data": "stocks"},
        "encode": {
          "enter": {
            "x": {"scale": "xscale", "field": "date"},
            "y": {"scale": "yscale", "field": "price"},
            "y2": {"scale": "yscale", "value": 0},
            "fill": {"scale": "pattern", "field": "symbol"},
            "stroke": {"value": "black"},
            "strokeWidth": {"value": 1}
          },
          "update": {
            "fillOpacity": {"value": 0.5}
          },
          "hover": {
            "fillOpacity": {"value": 0.8}
          }
        }
      }
    ]
  };

  var vegaView = new vega.View(vega.parse(vega_spec))
    .renderer('svg')  // for svg pattern fill, use "svg"
    .initialize("#vis")
    .hover()
    .run();
</script>
</body>
</html>
